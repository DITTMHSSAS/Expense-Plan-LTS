{
  "name": "Folder/АналогиРЖД",
  "dataView": "full",
  "source": {
    "type": "m",
    "expression": [
      "let",
      "\tИсточник = #\"Folder/АналогиРЖД\",",
      "    #\"Переименовываем системные системные реквизиты файлов\" = Table.RenameColumns(Источник,{{\"Name\", \"_ИмяФайла\"}, {\"Date accessed\", \"_ДатаЧтенияФайла\"}, {\"Date modified\", \"_ДатаИзмененияФайла\"}, {\"Date created\", \"_ДатаСозданияФайла\"}, {\"Folder Path\", \"_Путь\"}}),",
      "\t#\"Отбираем нужные файлы\" = Table.SelectRows(#\"Переименовываем системные системные реквизиты файлов\", each ([Extension] = \".xlsx\")),",
      "\t#\"Добавляем содержимое файлов\" = Table.AddColumn(#\"Отбираем нужные файлы\", \"Данные\", each Excel.Workbook([Content])),",
      "\t#\"Разворачиваем контейнеры Excel\" = Table.ExpandTableColumn(#\"Добавляем содержимое файлов\", \"Данные\", {\"Name\", \"Data\", \"Item\", \"Kind\", \"Hidden\"}, {\"Name\", \"Data\", \"Item\", \"Kind\", \"Hidden\"}),",
      "\t#\"Отбираем нужные контейнеры Excel\" = Table.SelectRows(#\"Разворачиваем контейнеры Excel\", each ([Item] = \"ИСХ\" and [Kind] = \"Table\")),",
      "\t#\"Удаляем ненужные системные колонки\" = Table.RemoveColumns(#\"Отбираем нужные контейнеры Excel\",{\"Name\", \"Item\", \"Kind\", \"Hidden\", \"Content\", \"Extension\", \"Attributes\"}),",
      "\t#\"Разворачиваем таблицы Excel\" = Table.ExpandTableColumn(#\"Удаляем ненужные системные колонки\", \"Data\", {\"Код СКМТР\",\"Наименование\",\"Ед\",\"ЭталонКодСКМТР\",\"ЭталонНаименование\",\"ЭталонЕд\",\"Коэффициент\",\"Применимость\",\"Примечания\"}, {\"Код СКМТР\",\"Наименование\",\"Ед\",\"ЭталонКодСКМТР\",\"ЭталонНаименование\",\"ЭталонЕд\",\"Коэффициент\",\"Применимость\",\"Примечания\"}),",
      "    #\"Преобразуем типы данных\" = Table.TransformColumnTypes(#\"Разворачиваем таблицы Excel\",{{\"Код СКМТР\", type text}}),",
      "    #\"Добавляем колонку с индексом строки\" = Table.AddIndexColumn(#\"Преобразуем типы данных\", \"Индекс\", 2, 1),",
      "    #\"Итоговая таблица\" = Table.SelectRows(#\"Добавляем колонку с индексом строки\", each true)",
      "in",
      "#\"Итоговая таблица\""
    ]
  }
}