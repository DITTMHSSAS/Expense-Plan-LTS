{
  "name": "__!сцЦУНР",
  "mode": "import",
  "source": {
    "type": "calculated",
    "expression": [
      "--    \"!СЦЕНАРИЙ\", \"ЭРС+, Годовой план 2023\",",
      "",
      "VAR  tPlans1 = SUMMARIZE( FILTER('Планы',",
      "            'Планы'[Год] = 2024",
      "            && 'Планы'[ТипПланирования] = \"Годовой план\"",
      "            && 'Планы'[ПринадлежностьМР]=\"Место ремонта ЛТС\"",
      "            && SWITCH(TRUE(),",
      "                    'Планы'[КлассОбъектаРемонта] = \"Секция\" &&",
      "                    'Планы'[СценарииПланирования] IN { \"3. План УК ЛТ скорректированный\"},",
      "                    --'Планы'[СценарииПланирования] IN { \"0,Предварительный (АПР)\" },",
      "                    TRUE()",
      "                )",
      "            ),",
      "    'Планы'[_Источник],",
      "    'Планы'[TIMESTAMP],",
      "",
      "    'Планы'[Год],",
      "    ",
      "    'Планы'[Сезонность],",
      "",
      "    'Планы'[СценарииПланирования],",
      "    'Планы'[ТипПланирования],",
      "",
      "    'Планы'[ВидРемонта],",
      "    'Планы'[КлассОбъектаРемонта],",
      "    'Планы'[ОбъектРемонта],",
      "    'Планы'[ОбъектРемонтаШаблон],",
      "    'Планы'[ОбъектРемонтаШаблонСерии],",
      "",
      "    'Планы'[СЛД],",
      "    'Планы'[МестоРемонта],",
      "    ",
      "    'Планы'[ДепоПриписки],",
      "    'Планы'[ДоговорСО],",
      "    'Планы'[ДрайверВыручки],",
      "    'Планы'[Модификация],",
      "    'Планы'[Статус],",
      "    'Планы'[ВидОперацииПланаПроизводства],",
      "    'Планы'[УправлениеПоЖД],",
      "    'Планы'[Филиал],",
      "    'Планы'[УстановленНа],",
      "    'Планы'[ПринадлежностьМР],",
      "    ",
      "    \"Период\",DATE( MAX( 'Планы'[Год] ), 1, 1 ),",
      "    \"КоличествоРемонтов\", SUM( 'Планы'[КоличествоРемонтов] )",
      ")",
      "",
      "VAR tPlan=SELECTCOLUMNS(tPlans1,",
      "    \"!СЦЕНАРИЙ\", \"ЦУНР_РЖД, Годовой план 2024\",",
      "    \"_план_Источник\",'Планы'[_Источник],",
      "    \"_план_TIMESTAMP\",'Планы'[TIMESTAMP],",
      "",
      "    \"_план_Год\",'Планы'[Год],",
      "    \"_план_Период\",[Период],",
      "    ",
      "    \"_план_Сезонность\",'Планы'[Сезонность],",
      "",
      "    \"_план_СценарииПланирования\",'Планы'[СценарииПланирования],",
      "    \"_план_ТипПланирования\",'Планы'[ТипПланирования],",
      "",
      "    \"_план_ВидРемонта\",'Планы'[ВидРемонта],",
      "    \"_план_ВидРемонтаПодбор\", SWITCH(TRUE(),",
      "                        'Планы'[ОбъектРемонтаШаблон] IN {\"ВЛ80С\",\"ВЛ80Р\", \"ВЛ80Т\", \"ВЛ80К\"}",
      "                        &&'Планы'[ВидРемонта]=\"ТР-1 цикл (4,8)\",\"ТР-1 цикл (4,8)\", // Для ВЛ80С,Р,Т,К норматив приходит в колонке ТО-3 и преобразуется в ТР-1 цикл (4,8) в '_НормативыЦУНР_РЖД'",
      "                        'Планы'[ВидРемонта]=\"ТР-1 цикл (6)\",\"ТР-1\",",
      "                        'Планы'[ВидРемонта]=\"ТР-1 цикл (4,8)\",\"ТР-1\",",
      "                        'Планы'[ВидРемонта]=\"ТО-2 У\",\"ТО-3\",",
      "                        'Планы'[ВидРемонта]",
      "    ),",
      "",
      "    \"_план_КлассОбъектаРемонта\",'Планы'[КлассОбъектаРемонта],",
      "    \"_план_ОбъектРемонта\",'Планы'[ОбъектРемонта],",
      "    \"_план_ОбъектРемонтаШаблон\",'Планы'[ОбъектРемонтаШаблон],",
      "",
      "    \"_план_ОбъектРемонтаШаблонПодбор\",SWITCH(TRUE(),",
      "                    'Планы'[ДоговорСО]=\"Договор 285\"&&'Планы'[ОбъектРемонтаШаблон]=\"3ТЭ10УК\"&&'Планы'[ВидРемонта]=\"ТО-5Б (плановый)\",\"2ТЭ10УК\",",
      "                    'Планы'[ДоговорСО]=\"Договор 285\"&&'Планы'[ОбъектРемонтаШаблон]=\"3ТЭ10УК\"&&'Планы'[ВидРемонта]=\"ТО-5В\",\"2ТЭ10УК\",",
      "                    'Планы'[ДоговорСО]=\"Договор 285\"&&'Планы'[ОбъектРемонтаШаблон]=\"3ТЭ10УК\"&&'Планы'[ВидРемонта]=\"ТО-4\",\"2ТЭ10УК\",",
      "                    'Планы'[ДоговорСО]=\"Договор 285\"&&'Планы'[ОбъектРемонтаШаблон]=\"ВЛ65\"&&'Планы'[ВидРемонта]=\"ТО-4\",\"ЭП2К\",",
      "                    'Планы'[ДоговорСО]=\"Договор 285\"&&'Планы'[ОбъектРемонтаШаблон]=\"ТЭМ18Д\"&&'Планы'[ВидРемонта]=\"ТО-4\",\"ТЭМ18\",",
      "                    'Планы'[ДоговорСО]=\"Договор 285\"&&'Планы'[ОбъектРемонтаШаблон]=\"ТЭМ18ДМ\"&&'Планы'[ВидРемонта]=\"ТО-4\",\"ТЭМ18\",",
      "                    'Планы'[ДоговорСО]=\"Договор 285\"&&'Планы'[ОбъектРемонтаШаблон]=\"ТЭМ2\"&&'Планы'[ВидРемонта]=\"ТО-4\",\"ТЭМ18\",",
      "                    'Планы'[ДоговорСО]=\"Договор 285\"&&'Планы'[ОбъектРемонтаШаблон]=\"ТЭМ2А\"&&'Планы'[ВидРемонта]=\"ТО-4\",\"ТЭМ18\",",
      "                    'Планы'[ДоговорСО]=\"Договор 285\"&&'Планы'[ОбъектРемонтаШаблон]=\"ТЭМ2У\"&&'Планы'[ВидРемонта]=\"ТО-4\",\"ТЭМ18\",",
      "                    'Планы'[ДоговорСО]=\"Договор 285\"&&'Планы'[ОбъектРемонтаШаблон]=\"ТЭМ2УМ\"&&'Планы'[ВидРемонта]=\"ТО-4\",\"ТЭМ18\",",
      "                    'Планы'[ДоговорСО]=\"Договор 285\"&&'Планы'[ОбъектРемонтаШаблон]=\"ТЭМ2УМТ\"&&'Планы'[ВидРемонта]=\"ТО-4\",\"ТЭМ18\",",
      "                    'Планы'[ДоговорСО]=\"Договор 285\"&&'Планы'[ОбъектРемонтаШаблон]=\"ТЭМ31\"&&'Планы'[ВидРемонта]=\"ТО-4\",\"ТЭМ18\",",
      "                    'Планы'[ДоговорСО]=\"Договор 285\"&&'Планы'[ОбъектРемонтаШаблон]=\"ТЭП70БС\"&&'Планы'[ВидРемонта]=\"ТО-5Д\",\"ТЭП70\",",
      "                    'Планы'[ДоговорСО]=\"Договор 285\"&&'Планы'[ОбъектРемонтаШаблон]=\"Э5К\"&&'Планы'[ВидРемонта]=\"ТО-4\",\"2ЭС5К\",",
      "                    'Планы'[ДоговорСО]=\"Договор 285\"&&'Планы'[ОбъектРемонтаШаблон]=\"ЭП1\"&&'Планы'[ВидРемонта]=\"ТО-4\",\"ЭП2К\",",
      "                    'Планы'[ДоговорСО]=\"Договор 285\"&&'Планы'[ОбъектРемонтаШаблон]=\"ЭП1П\"&&'Планы'[ВидРемонта]=\"ТО-4\",\"ЭП2К\",",
      "                    'Планы'[ДоговорСО]=\"Договор Рослокомотив\"&&'Планы'[ОбъектРемонтаШаблон]=\"2ТЭ28\"&&'Планы'[ВидРемонта]=\"ТР-1\",\"2ТЭ25КМ\",",
      "                    'Планы'[ДоговорСО]=\"Договор Рослокомотив\"&&'Планы'[ОбъектРемонтаШаблон]=\"2ТЭ28\"&&'Планы'[ВидРемонта]=\"ТР-2\",\"2ТЭ25КМ\",",
      "                    'Планы'[ДоговорСО]=\"Договор Рослокомотив\"&&'Планы'[ОбъектРемонтаШаблон]=\"2ТЭ28\"&&'Планы'[ВидРемонта]=\"ТО-2\",\"2ТЭ25КМ\",",
      "                    'Планы'[ДоговорСО]=\"Договор Рослокомотив\"&&'Планы'[ОбъектРемонтаШаблон]=\"2ТЭ28\"&&'Планы'[ВидРемонта]=\"ТО-3\",\"2ТЭ25КМ\",",
      "                    'Планы'[ДоговорСО]=\"Договор Рослокомотив\"&&'Планы'[ОбъектРемонтаШаблон]=\"2ТЭ28\"&&'Планы'[ВидРемонта]=\"ТО-5Д\",\"2ТЭ25КМ\",",
      "                    'Планы'[ДоговорСО]=\"Договор Рослокомотив\"&&'Планы'[ОбъектРемонтаШаблон]=\"3ТЭ28\"&&'Планы'[ВидРемонта]=\"ТО-2\",\"2ТЭ25КМ\",",
      "                    'Планы'[ДоговорСО]=\"Договор Рослокомотив\"&&'Планы'[ОбъектРемонтаШаблон]=\"3ТЭ28\"&&'Планы'[ВидРемонта]=\"ТР-2\",\"2ТЭ25КМ\",",
      "                    'Планы'[ДоговорСО]=\"Договор Рослокомотив\"&&'Планы'[ОбъектРемонтаШаблон]=\"3ТЭ28\"&&'Планы'[ВидРемонта]=\"ТО-3\",\"2ТЭ25КМ\",",
      "                    'Планы'[ДоговорСО]=\"Договор Рослокомотив\"&&'Планы'[ОбъектРемонтаШаблон]=\"3ТЭ28\"&&'Планы'[ВидРемонта]=\"ТР-1\",\"2ТЭ25КМ\",",
      "                    'Планы'[ДоговорСО]=\"Договор Рослокомотив\"&&'Планы'[ОбъектРемонтаШаблон]=\"3ТЭ28-серед\"&&'Планы'[ВидРемонта]=\"ТО-2\",\"2ТЭ25КМ\",",
      "                    'Планы'[ДоговорСО]=\"Договор Рослокомотив\"&&'Планы'[ОбъектРемонтаШаблон]=\"3ТЭ28-серед\"&&'Планы'[ВидРемонта]=\"ТР-2\",\"2ТЭ25КМ\",",
      "                    'Планы'[ДоговорСО]=\"Договор Рослокомотив\"&&'Планы'[ОбъектРемонтаШаблон]=\"3ТЭ28-серед\"&&'Планы'[ВидРемонта]=\"ТО-3\",\"2ТЭ25КМ\",",
      "                    'Планы'[ДоговорСО]=\"Договор Рослокомотив\"&&'Планы'[ОбъектРемонтаШаблон]=\"3ТЭ28-серед\"&&'Планы'[ВидРемонта]=\"ТР-1\",\"2ТЭ25КМ\",",
      "                    'Планы'[ДоговорСО]=\"Договор Рослокомотив\"&&'Планы'[ОбъектРемонтаШаблон]=\"ТЭМ18ДМ\"&&'Планы'[ВидРемонта]=\"ТО-4\",\"ТЭМ18\",",
      "                    'Планы'[ДоговорСО]=\"Договор Рослокомотив\"&&'Планы'[ОбъектРемонтаШаблон]=\"ТЭМ31М\"&&'Планы'[ВидРемонта]=\"ТО-4\",\"ТЭМ18\",",
      "                'Планы'[ОбъектРемонтаШаблон]",
      "    ),",
      "",
      "    \"_план_ОбъектРемонтаШаблонСерии\",'Планы'[ОбъектРемонтаШаблонСерии],",
      "",
      "    \"_план_СЛД\",'Планы'[СЛД],",
      "    \"_план_МестоРемонта\",'Планы'[МестоРемонта],",
      "    ",
      "    \"_план_ДепоПриписки\",'Планы'[ДепоПриписки],",
      "    \"_план_ДоговорСО\",'Планы'[ДоговорСО],",
      "    \"_план_ДрайверВыручки\",'Планы'[ДрайверВыручки],",
      "    \"_план_Модификация\",'Планы'[Модификация],",
      "    \"_план_Статус\",'Планы'[Статус],",
      "    \"_план_ВидОперацииПланаПроизводства\",'Планы'[ВидОперацииПланаПроизводства],",
      "    \"_план_УправлениеПоЖД\",'Планы'[УправлениеПоЖД],",
      "    \"_план_Филиал\",'Планы'[Филиал],",
      "    \"_план_УстановленНа\",'Планы'[УстановленНа],",
      "    \"_план_ПринадлежностьМР\",'Планы'[УстановленНа],",
      "",
      "    \"_план_КоличествоРемонтов\", [КоличествоРемонтов]   ",
      ")",
      "",
      "VAR tNorms=SELECTCOLUMNS(",
      "    FILTER('Нормативы',",
      "        'Нормативы'[ВидРесурса]=\"ТМЦ\"&&",
      "        SWITCH(TRUE(),",
      "            'Нормативы'[ВидИсточника]=\"АСУСГпоМК\",'Нормативы'[ТипСпецификации] IN { \"Эталонная\", \"Бюджетная\" },",
      "            'Нормативы'[ВидИсточника]=\"Excel\",'Нормативы'[ТипСпецификации] IN { \"ЦУНР_РЖД\"},",
      "            FALSE())",
      "    ),",
      "    \"_Источник\",'Нормативы'[РесурснаяСпецификация],",
      "    \"ВидИсточника\",'Нормативы'[ВидИсточника],",
      "    \"_норм_ВидРесурса\",'Нормативы'[ВидРесурса],",
      "    \"_Код НСИ\",'Нормативы'[Код НСИ],    ",
      "    \"_Код СКМТР\",'Нормативы'[Код СКМТР],",
      "    \"_Номенклатура\",'Нормативы'[_Номенклатура],",
      "    \"_НоменклатураНСИ\",'Нормативы'[_НоменклатураНСИ],",
      "    \"ЕдИзм\",'Нормативы'[ЕдИзм],",
      "    \"_норм_Серия\",'Нормативы'[Серия],",
      "    \"_норм_ВидРемонта\",'Нормативы'[ВидРемонта],",
      "    ",
      "    \"_норм_Модификация\",'Нормативы'[Модификация],",
      "    \"_норм_Сверхцикл\",'Нормативы'[Сверхцикл],",
      "    \"_норм_Сезонность\",'Нормативы'[Сезонность],",
      "    \"_норм_СтатусРесурснойСпецификации\",'Нормативы'[СтатусРесурснойСпецификации],",
      "    \"_норм_СтатусНоменклатуры\",'Нормативы'[СтатусНоменклатуры],",
      "    \"_норм_КомплектМПИ\",'Нормативы'[КомплектМПИ],",
      "    \"_норм_ТарифныйРазряд\",'Нормативы'[ТарифныйРазряд],",
      "    \"_норм_ДоговорСО\",'Нормативы'[ДоговорСО],",
      "    \"_норм_ВидРабот\",'Нормативы'[ВидРабот],",
      "    \"_норм_СЛД\",'Нормативы'[СЛД],",
      "    \"_норм_МестоРемонта\",'Нормативы'[МестоРемонта],",
      "    ",
      "    \"_норм_КлассОбъектаРемонта\",'Нормативы'[КлассОбъектаРемонта],",
      "    \"_норм_ОбъектРемонтаШаблон\",'Нормативы'[ОбъектРемонтаШаблон],",
      "    \"_норм_ОбъектРемонтаШаблонСерии\",'Нормативы'[ОбъектРемонтаШаблонСерии],",
      "    ",
      "    \"_Количество\",'Нормативы'[_Количество],",
      "    \"_норм_КоличествоОбязательное\",'Нормативы'[_КоличествоОбязательное],",
      "    \"_КоличествоПроектЦиклЦУНР\",'Нормативы'[_КоличествоПроектЦиклЦУНР],",
      "    \"_КоличествоПроектЦиклЦУНР+\",'Нормативы'[_КоличествоПроектЦиклЦУНР+],",
      "    \"_норм_ТипСпецификации\", 'Нормативы'[ТипСпецификации],",
      "    \"СтатусЦУНРплюсЦУНР\", 'Нормативы'[СтатусЦУНРплюсЦУНР],",
      "    \"TIMESTAMP\",'Нормативы'[TIMESTAMP],",
      "    \"_норм_НачалоДействияРС\",'Нормативы'[НачалоДействияРС],",
      "    \"_норм_КонецДействияРС\",'Нормативы'[КонецДействияРС],",
      "    \"_норм_ПланируетсяОтдельно\",'Нормативы'[ПланируетсяОтдельно],",
      "    \"_норм_ПодзапросИсточник\",'Нормативы'[ПодзапросИсточник]",
      ")",
      "",
      "VAR  tRetTable = GENERATEALL(",
      "    tPlan,",
      "    (",
      "        VAR  tObj=IF([_план_КлассОбъектаРемонта]=\"Оборудование\",[_план_ОбъектРемонта],[_план_ОбъектРемонтаШаблонПодбор])--,[_план_ОбъектРемонтаШаблон])",
      "",
      "        VAR  tPrzTSUNR_RGD = NOT ( ISBLANK( COUNTROWS( FILTER( tNorms,",
      "            [_норм_ОбъектРемонтаШаблон] = tObj",
      "            && [_норм_ВидРемонта] = [_план_ВидРемонтаПодбор]",
      "            && [_норм_ТипСпецификации] = \"ЦУНР_РЖД\"",
      "            --&& OR(ISBLANK([_норм_МестоРемонта]),[_норм_МестоРемонта] = \"\" )",
      "            --&& OR( [_норм_Сезонность] = [_план_Сезонность], [_норм_Сезонность] = \"Всесезонная\" )",
      "            --&& [_норм_Модификация] = [_план_Модификация]",
      "        ) ) ) )   ",
      "        ",
      "--        VAR  tPrzTSUNR = NOT ( ISBLANK( COUNTROWS( FILTER( tNorms,",
      "--            [_норм_ОбъектРемонтаШаблон] = tObj",
      "--            && [_норм_ВидРемонта] = [_план_ВидРемонтаПодбор]",
      "--            && [_норм_ТипСпецификации] = \"Норма ЦУНР\"",
      "--            && OR(ISBLANK([_норм_МестоРемонта]),[_норм_МестоРемонта] = \"\" )",
      "--            && OR( [_норм_Сезонность] = [_план_Сезонность], [_норм_Сезонность] = \"Всесезонная\" )",
      "--           && [_норм_Модификация] = [_план_Модификация]",
      "--        ) ) ) )   ",
      "        ",
      "--        VAR  tPrzTSUNRplus = NOT ( ISBLANK( COUNTROWS( FILTER( tNorms,",
      "--            [_норм_ОбъектРемонтаШаблон] = tObj",
      "--            && [_норм_ВидРемонта] = [_план_ВидРемонтаПодбор]",
      "--            && [_норм_ТипСпецификации] = \"Норма ЦУНР +\"",
      "--            && OR(ISBLANK([_норм_МестоРемонта]),[_норм_МестоРемонта] = \"\" )",
      "--            && OR( [_норм_Сезонность] = [_план_Сезонность], [_норм_Сезонность] = \"Всесезонная\" )",
      "--            && [_норм_Модификация] = [_план_Модификация]",
      "--        ) ) ) ) ",
      "",
      "--        VAR  tPrzERSplus = NOT ( ISBLANK( COUNTROWS( FILTER( tNorms,",
      "--            [_норм_ОбъектРемонтаШаблон] = tObj",
      "--            && [_норм_ВидРемонта] = [_план_ВидРемонтаПодбор]",
      "--            && [_норм_ТипСпецификации] = \"Эталонная (эксперимент)\"",
      "--            && OR(ISBLANK([_норм_МестоРемонта]),[_норм_МестоРемонта] = \"\" )",
      "--            && OR( [_норм_Сезонность] = [_план_Сезонность], [_норм_Сезонность] = \"Всесезонная\" )",
      "--        ) ) ) )",
      "        VAR  tPrzERS = NOT ( ISBLANK( COUNTROWS( FILTER( tNorms,",
      "            [_норм_ОбъектРемонтаШаблон] = tObj",
      "            && [_норм_ВидРемонта] = [_план_ВидРемонтаПодбор]",
      "            && [_норм_ТипСпецификации] = \"Эталонная\"",
      "            && OR(ISBLANK([_норм_МестоРемонта]),[_норм_МестоРемонта] = \"\" )",
      "            && OR( [_норм_Сезонность] = [_план_Сезонность], [_норм_Сезонность] = \"Всесезонная\" )",
      "        ) ) ) )",
      "        ",
      "        VAR  tPrzBudget20 = NOT ( ISBLANK( COUNTROWS( FILTER( tNorms,",
      "            [_норм_ОбъектРемонтаШаблон] = tObj",
      "            && [_норм_ВидРемонта] = [_план_ВидРемонтаПодбор]",
      "            && [_норм_ТипСпецификации] = \"Бюджетная\"",
      "            && [_норм_НачалоДействияРС] = DATE( 2020, 1, 1 )",
      "            && [_норм_СЛД]=[_план_СЛД]",
      "            && [_норм_МестоРемонта]=[_план_МестоРемонта]",
      "            && [_норм_Модификация] = [_план_Модификация]",
      "        ) ) ) )",
      "        VAR  tPrzBudget21 = NOT ( ISBLANK( COUNTROWS( FILTER( tNorms,",
      "            [_норм_ОбъектРемонтаШаблон] = tObj",
      "            && [_норм_ВидРемонта] = [_план_ВидРемонтаПодбор]",
      "            && [_норм_ТипСпецификации] = \"Бюджетная\"",
      "            && [_норм_НачалоДействияРС] = DATE( 2021, 1, 1 )",
      "            && [_норм_СЛД]=[_план_СЛД]",
      "            && [_норм_МестоРемонта]=[_план_МестоРемонта]",
      "            && [_норм_Модификация] = [_план_Модификация]",
      "        ) ) ) )",
      "        VAR  tPrzBudget22 = NOT ( ISBLANK( COUNTROWS( FILTER( tNorms,",
      "            [_норм_ОбъектРемонтаШаблон] = tObj",
      "            && [_норм_ВидРемонта] = [_план_ВидРемонтаПодбор]",
      "            && [_норм_ТипСпецификации] = \"Бюджетная\"",
      "            && [_норм_НачалоДействияРС] = DATE( 2022, 1, 1 )",
      "            && [_норм_СЛД]=[_план_СЛД]",
      "            && [_норм_МестоРемонта]=[_план_МестоРемонта]",
      "            && [_норм_Модификация] = [_план_Модификация]",
      "        ) ) ) )",
      "        ",
      "        ",
      "        VAR tRetTable1=FILTER(tNorms,",
      "            [_норм_ОбъектРемонтаШаблон] = tObj",
      "            --&&[ВидИсточника]=\"АСУСГпоМК\"",
      "            && [_норм_ВидРемонта] = [_план_ВидРемонтаПодбор]",
      "            && SWITCH(TRUE(),",
      "                --tPrzTSUNRplus,[_норм_ТипСпецификации] = \"Норма ЦУНР +\",",
      "                --tPrzTSUNR,    [_норм_ТипСпецификации] = \"Норма ЦУНР\",",
      "                tPrzTSUNR_RGD,    [_норм_ТипСпецификации] = \"ЦУНР_РЖД\",",
      "",
      "                --tPrzERSplus,  [_норм_ТипСпецификации] = \"Эталонная (эксперимент)\",",
      "                tPrzERS,      [_норм_ТипСпецификации] = \"Эталонная\",",
      "",
      "                tPrzBudget20, [_норм_ТипСпецификации] = \"Бюджетная\",",
      "                tPrzBudget21, [_норм_ТипСпецификации] = \"Бюджетная\",",
      "                tPrzBudget22, [_норм_ТипСпецификации] = \"Бюджетная\",",
      "                FALSE())",
      "--            && SWITCH(TRUE(),",
      "--                tPrzTSUNRplus,[ВидИсточника]=\"АСУСГпоМК\",",
      "--                tPrzERSplus,  [ВидИсточника]=\"АСУСГпоМК\",",
      "--                tPrzTSUNR,    [ВидИсточника]=\"АСУСГпоМК\",",
      "--                tPrzERS,      [ВидИсточника]=\"АСУСГпоМК\",             ",
      "--                tPrzBudget20, [ВидИсточника]=\"АСУСГпоМК\",",
      "--                tPrzBudget21, [ВидИсточника]=\"АСУСГпоМК\",",
      "--                tPrzBudget22, [ВидИсточника]=\"АСУСГпоМК\",",
      "--                FALSE())",
      "            && SWITCH(TRUE(),",
      "                --tPrzTSUNRplus,TRUE(),",
      "                --tPrzTSUNR,    TRUE(),",
      "                tPrzTSUNR_RGD,    TRUE(),",
      "",
      "                --tPrzERSplus,  TRUE(),",
      "                tPrzERS,      TRUE(),",
      "                ",
      "                tPrzBudget20, [_норм_НачалоДействияРС] = DATE( 2020, 1, 1 ),",
      "                tPrzBudget21, [_норм_НачалоДействияРС] = DATE( 2021, 1, 1 ),",
      "                tPrzBudget22, [_норм_НачалоДействияРС] = DATE( 2022, 1, 1 ),",
      "                FALSE())",
      "            && SWITCH(TRUE(),",
      "                --tPrzTSUNRplus,TRUE(),",
      "                --tPrzTSUNR,    TRUE(),",
      "                tPrzTSUNR_RGD,    TRUE(),",
      "",
      "                --tPrzERSplus,  TRUE(),",
      "                tPrzERS,      TRUE(),  ",
      "",
      "                tPrzBudget20, [_норм_СЛД]=[_план_СЛД],",
      "                tPrzBudget21, [_норм_СЛД]=[_план_СЛД],",
      "                tPrzBudget22, [_норм_СЛД]=[_план_СЛД],",
      "                FALSE())",
      "            && SWITCH(TRUE(),",
      "                --tPrzTSUNRplus,OR(ISBLANK([_норм_МестоРемонта]),[_норм_МестоРемонта] = \"\" ),",
      "                --tPrzTSUNR,    OR(ISBLANK([_норм_МестоРемонта]),[_норм_МестоРемонта] = \"\" ),",
      "                tPrzTSUNR_RGD,    TRUE(),",
      "",
      "                --tPrzERSplus,  OR(ISBLANK([_норм_МестоРемонта]),[_норм_МестоРемонта] = \"\" ),",
      "                tPrzERS,      OR(ISBLANK([_норм_МестоРемонта]),[_норм_МестоРемонта] = \"\" ),",
      "                    ",
      "                tPrzBudget20, [_норм_МестоРемонта]=[_план_МестоРемонта],",
      "                tPrzBudget21, [_норм_МестоРемонта]=[_план_МестоРемонта],",
      "                tPrzBudget22, [_норм_МестоРемонта]=[_план_МестоРемонта],",
      "                FALSE())",
      "            && SWITCH(TRUE(),",
      "                --tPrzTSUNRplus,OR( [_норм_Сезонность] = [_план_Сезонность], [_норм_Сезонность] = \"Всесезонная\" ),",
      "                --tPrzTSUNR,    OR( [_норм_Сезонность] = [_план_Сезонность], [_норм_Сезонность] = \"Всесезонная\" ),",
      "                tPrzTSUNR_RGD,    TRUE(),",
      "",
      "                --tPrzERSplus,  OR( [_норм_Сезонность] = [_план_Сезонность], [_норм_Сезонность] = \"Всесезонная\" ),                 ",
      "                tPrzERS,      OR( [_норм_Сезонность] = [_план_Сезонность], [_норм_Сезонность] = \"Всесезонная\" ),",
      "",
      "                tPrzBudget20, TRUE(),",
      "                tPrzBudget21, TRUE(),",
      "                tPrzBudget22, TRUE(),",
      "                FALSE())",
      "            && SWITCH(TRUE(),",
      "                --tPrzTSUNRplus,[_норм_Модификация] = [_план_Модификация],",
      "                --tPrzTSUNR,    [_норм_Модификация] = [_план_Модификация],",
      "                tPrzTSUNR_RGD,    TRUE(),",
      "",
      "                --tPrzERSplus,  TRUE(),",
      "                tPrzERS,      TRUE(), ",
      "                ",
      "                tPrzBudget20, [_норм_Модификация] = [_план_Модификация],",
      "                tPrzBudget21, [_норм_Модификация] = [_план_Модификация],",
      "                tPrzBudget22, [_норм_Модификация] = [_план_Модификация],",
      "                FALSE())",
      "        )",
      "        RETURN",
      "        tRetTable1",
      "    )",
      ")",
      "RETURN",
      "tRetTable//////////////////////////////////"
    ]
  }
}