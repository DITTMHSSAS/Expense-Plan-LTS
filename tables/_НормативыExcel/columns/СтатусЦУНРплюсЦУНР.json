{
  "type": "calculated",
  "name": "СтатусЦУНРплюсЦУНР",
  "dataType": "string",
  "isDataTypeInferred": true,
  "expression": [
    "VAR tVal1='_НормативыExcel'[Серия]",
    "VAR tVal2='_НормативыExcel'[Вид ремонта]",
    "VAR tVal3=SWITCH('_НормативыExcel'[Тип],",
    "                    \"ЦУНР\",\"ЦУНР+\",",
    "                    \"ЦУНР+\",\"ЦУНР\",",
    "                    \"ЭРС\",\"ЭРС+\",",
    "                    \"ЭРС+\",\"ЭРС\",",
    "                    \"???\"",
    "            )",
    "VAR tVal33='_НормативыExcel'[Тип]",
    "VAR tVal4='_НормативыExcel'[Код НСИ]",
    "VAR tVal5='_НормативыExcel'[ЕдИзм]",
    "",
    "VAR tTable=FILTER(ALL('_НормативыExcel'),",
    "        tVal1='_НормативыExcel'[Серия]&&",
    "        tVal2='_НормативыExcel'[Вид ремонта]&&",
    "        tVal3='_НормативыExcel'[Тип]&&",
    "        tVal4='_НормативыExcel'[Код НСИ]",
    "--        tVal5=''_НормативыExcel''[ЕдИзм]",
    ")",
    "",
    "VAR tCol1='_НормативыExcel'[_ПроектЦикл]",
    "VAR tCol2=AVERAGEX(tTable,'_НормативыExcel'[_ПроектЦикл])",
    "",
    "VAR tRet=ISBLANK(COUNTROWS(tTable))",
    "RETURN",
    "SWITCH(TRUE(),",
    "    tRet,\"Номенклатура имеется в \"&tVal33&\" но отсутствует в \"&tVal3,",
    "    tCol1=tCol2, \"Номенклатура имеется в \"&tVal33&\" и в \"&tVal3&\", количество равно\",",
    "    tCol1>tCOl2, \"Номенклатура имеется в \"&tVal33&\" и в \"&tVal3&\", но в меньшем количестве\",",
    "    tCol1<tCOl2, \"Номенклатура имеется в \"&tVal33&\" и в \"&tVal3&\", но в большем количестве\",",
    "    \"Неожиданный результат\"",
    ")",
    "",
    ""
  ]
}